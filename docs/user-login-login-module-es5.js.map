{"version":3,"sources":["webpack:///src/app/user/login/login.page.html","webpack:///src/app/user/login/login.module.ts","webpack:///src/app/services/app.service.ts","webpack:///src/app/user/login/login-routing.module.ts","webpack:///src/app/user/login/login.page.ts","webpack:///src/app/user/login/login.page.scss"],"names":["LoginPageModule","imports","declarations","AppService","router","alertController","storage","title","text","create","header","message","buttons","handler","alert","present","Promise","resolve","reject","get","type","subscribe","next","data","error","console","providedIn","routes","path","component","LoginPageRoutingModule","forChild","exports","LoginPage","fbAuth","fbStore","app","events","provider","authProvider","GoogleAuthProvider","signInWithPopup","then","userData","uid","user","displayName","email","photoURL","set","JSON","stringify","publish","firestore","collection","doc","exists","userProfile","id","myAlert","navigate","log","selector","template"],"mappings":"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","file":"user-login-login-module-es5.js","sourcesContent":["export default \"<ion-header>\\r\\n  <ion-toolbar>\\r\\n\\r\\n    <ion-buttons slot=\\\"start\\\">\\r\\n      <ion-menu-button></ion-menu-button>\\r\\n    </ion-buttons>\\r\\n\\r\\n    <ion-title>Login / Entrar</ion-title>\\r\\n\\r\\n  </ion-toolbar>\\r\\n</ion-header>\\r\\n\\r\\n<ion-content>\\r\\n\\r\\n  <div class=\\\"ion-padding\\\">\\r\\n\\r\\n    <h2>Olá!</h2>\\r\\n\\r\\n    <p>Para que você possa acessar os serviços deste aplicativo, é necessário estar logado(a)...</p>\\r\\n    <p>Escolha um método de entrada clicando no botão.</p>\\r\\n\\r\\n    <div class=\\\"login-table\\\">\\r\\n\\r\\n      <p>Entrar com:</p>&nbsp;\\r\\n\\r\\n      <!-- 3.1) Botões de login com redes sociais -->\\r\\n\\r\\n      <ion-button expand=\\\"block\\\" (click)=\\\"login('google')\\\">\\r\\n        <ion-icon name=\\\"logo-google\\\" slot=\\\"start\\\"></ion-icon>\\r\\n        <ion-label>Google</ion-label>\\r\\n      </ion-button>\\r\\n\\r\\n      <ion-button class=\\\"ion-margin-top\\\" expand=\\\"block\\\" (click)=\\\"login('facebook')\\\">\\r\\n        <ion-icon name=\\\"logo-facebook\\\" slot=\\\"start\\\"></ion-icon>\\r\\n        <ion-label>Facebook</ion-label>\\r\\n      </ion-button>\\r\\n\\r\\n      <ion-button class=\\\"ion-margin-top\\\" expand=\\\"block\\\" (click)=\\\"login('twitter')\\\">\\r\\n        <ion-icon name=\\\"logo-twitter\\\" slot=\\\"start\\\"></ion-icon>\\r\\n        <ion-label>Twitter</ion-label>\\r\\n      </ion-button>\\r\\n\\r\\n      <ion-button class=\\\"ion-margin-top\\\" expand=\\\"block\\\" (click)=\\\"login('github')\\\">\\r\\n        <ion-icon name=\\\"logo-github\\\" slot=\\\"start\\\"></ion-icon>\\r\\n        <ion-label>GitHub</ion-label>\\r\\n      </ion-button>\\r\\n\\r\\n      <!-- ... -->\\r\\n\\r\\n    </div>\\r\\n\\r\\n  </div>\\r\\n\\r\\n</ion-content>\";","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\n\r\nimport { IonicModule } from '@ionic/angular';\r\n\r\nimport { LoginPageRoutingModule } from './login-routing.module';\r\n\r\nimport { LoginPage } from './login.page';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    IonicModule,\r\n    LoginPageRoutingModule\r\n  ],\r\n  declarations: [LoginPage]\r\n})\r\nexport class LoginPageModule {}\r\n","/**\r\n * Serviços de uso geral\r\n *    Aqui estão alguns serviços usados em toda ou parte do aplicativo\r\n * @author Por Luferat\r\n */\r\n\r\nimport { Injectable } from '@angular/core';\r\n\r\n// 3.1) Importa dependências\r\nimport { Router } from '@angular/router'; // Roteamento\r\nimport { AlertController } from '@ionic/angular'; // Caixa de alerta\r\n\r\n// 4.1) Importa dependências\r\nimport { StorageMap } from '@ngx-pwa/local-storage'; // Armazenamento local\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class AppService {\r\n\r\n  constructor(\r\n\r\n    // 3.2) Injeção das dependências\r\n    public router: Router, // Roteamento\r\n    public alertController: AlertController, // Caixa de alerta\r\n\r\n    // 4.2) Injeção das dependências\r\n    private storage: StorageMap, // Armazenamento local\r\n  ) { }\r\n\r\n  // 3.3) Caixa de alerta para feedback (https://ionicframework.com/docs/api/alert)\r\n  async myAlert(title: string, text: string) {\r\n    const alert = await this.alertController.create({\r\n      header: title,\r\n      message: text,\r\n      buttons: [{\r\n        text: 'Ok',\r\n        handler: () => { return true; }\r\n      }]\r\n    });\r\n    await alert.present();\r\n  }\r\n\r\n  // 4.3) Método que detecta a presença do perfil local\r\n  async isProfile() {\r\n\r\n    // Constrói a promise\r\n    return new Promise<any>((resolve, reject) => {\r\n\r\n      // Lê o armazenamento local\r\n      this.storage.get('userProfile', { type: 'string' }).subscribe({\r\n        next: (data) => {\r\n\r\n          // Se perfil, retorna 'true'\r\n          if (data) resolve(true);\r\n\r\n          // Se não tem perfil, retorna 'false'\r\n          else resolve(false);\r\n        },\r\n\r\n        // Em caso de erro ao tentar acessar 'storage'\r\n        error: (error) => console.error(error)\r\n      });\r\n    });\r\n  }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nimport { LoginPage } from './login.page';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: LoginPage\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule],\r\n})\r\nexport class LoginPageRoutingModule {}\r\n","import { Component, OnInit } from '@angular/core';\r\n\r\n// 3.1) Importa dependências \r\nimport { AngularFireAuth } from '@angular/fire/auth'; // Autenticação\r\nimport { auth } from 'firebase/app'; // Firebase CLI\r\nimport { StorageMap } from '@ngx-pwa/local-storage'; // Armazenamento local\r\nimport { AngularFirestore } from '@angular/fire/firestore'; // Firestore\r\nimport { Router } from '@angular/router'; // Roteamento\r\nimport { AppService } from '../../services/app.service'; // Serviços de uso geral\r\nimport { EventsService } from '../../services/events.service'; // Dispara eventos globais\r\n\r\n@Component({\r\n  selector: 'app-login',\r\n  templateUrl: './login.page.html',\r\n  styleUrls: ['./login.page.scss'],\r\n})\r\nexport class LoginPage implements OnInit {\r\n\r\n  // 3.2) Variáveis locais\r\n  authProvider: any; // Provedor de login social\r\n  userData: any; // Dados do login do usuário\r\n  userProfile: any; // Dados do perfil do usuário\r\n\r\n  constructor(\r\n\r\n    // 3.3) Injeção de dependências\r\n    public fbAuth: AngularFireAuth, // Autenticação\r\n    public fbStore: AngularFirestore, // Firestore\r\n    private storage: StorageMap, // Armazenamento local\r\n    public app: AppService, // Serviços de uso geral\r\n    public router: Router, // Roteamento\r\n    public events: EventsService, // Dispara eventos globais\r\n  ) { }\r\n\r\n  ngOnInit() { }\r\n\r\n  // 3.4) Ação do botão de login\r\n  async login(provider: string) {\r\n\r\n    // Seleção do provedor de login social\r\n    // - Adicione outros provedores conforme a configuração do Firebase Authentication\r\n    switch (provider) {\r\n\r\n      case 'google':\r\n        this.authProvider = new auth.GoogleAuthProvider();\r\n        break;\r\n\r\n      case 'facebook':\r\n        alert('Você precisa implementar isso no Firebase Authentication!');\r\n        return false;\r\n        // this.authProvider = new auth.FacebookAuthProvider();\r\n        break;\r\n\r\n      case 'twitter':\r\n        alert('Você precisa implementar isso no Firebase Authentication!');\r\n        return false;\r\n        // this.authProvider = new auth.TwitterAuthProvider();\r\n        break;\r\n\r\n      case 'github':\r\n        alert('Você precisa implementar isso no Firebase Authentication!');\r\n        return false;\r\n        // this.authProvider = new auth.GithubAuthProvider();\r\n        break;\r\n\r\n      // case ....\r\n\r\n    }\r\n\r\n    // Login com popup no Firebase Auth\r\n    this.fbAuth.signInWithPopup(this.authProvider)\r\n\r\n      // Se logou\r\n      .then((data) => {\r\n\r\n        // Formata dados do usuário\r\n        this.userData = {\r\n          uid: data.user.uid,\r\n          displayName: data.user.displayName,\r\n          email: data.user.email,\r\n          photoURL: data.user.photoURL,\r\n\r\n          // 8.1) Provedor de login usado\r\n          provider: provider\r\n        }\r\n\r\n        // Salva no armazenamento local\r\n        this.storage.set('userData', JSON.stringify(this.userData)).subscribe({\r\n          next: () => {\r\n\r\n            // 3.6) Atualiza 'userData' no menu principal também (app.component.ts)\r\n            this.events.publish('userData', this.userData);\r\n\r\n            // Verifica se tem perfil no Firestore\r\n            this.fbStore.firestore.collection('users').doc(this.userData.uid).get()\r\n              .then((data) => {\r\n\r\n                // Se tem perfil\r\n                if (data.exists) {\r\n\r\n                  // Obtém dados do perfil\r\n                  this.userProfile = data.data();\r\n                  this.userProfile.uid = data.id;\r\n\r\n                  // Grava perfil no armazenamento local\r\n                  this.storage.set('userProfile', JSON.stringify(this.userProfile)).subscribe({\r\n                    next: () => {\r\n\r\n                      // Exibe alerta\r\n                      this.app.myAlert(\r\n                        `Olá ${this.userData.displayName}`,\r\n                        `Você já pode acessar todos os recursos do aplicativo.`\r\n                      );\r\n\r\n                      // Vai para a raiz\r\n                      this.router.navigate(['/']);\r\n                    },\r\n                    error: (error) => { console.error(error); }\r\n                  });\r\n\r\n                  // Se não tem perfil\r\n                } else {\r\n\r\n                  // 4.1) COMENTE --> Exibe alerta e vai para a rota '/user/new'\r\n                  // this.app.myAlert(\r\n                  //   `Olá ${this.userData.displayName}`,\r\n                  //   `Você precisa completar seu cadastro para usar todos os recursos do aplicativo.`\r\n                  // );\r\n\r\n                  // Vai para o cadatro de novo perfil\r\n                  this.router.navigate(['/user/new']);\r\n                }\r\n              })\r\n              .catch((error) => { console.error(error); });\r\n          },\r\n          error: (error) => { console.error(error); }\r\n        });\r\n      })\r\n      .catch((error) => { console.log(error); });\r\n  }\r\n}\r\n","export default \"@charset \\\"UTF-8\\\";\\n/* 3.1) Formata lista de botões */\\n.login-table {\\n  display: table;\\n  margin: auto;\\n  width: 220px;\\n}\\n.login-table ion-label {\\n  padding-left: 0.5rem;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvdXNlci9sb2dpbi9sb2dpbi5wYWdlLnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsZ0JBQWdCO0FBQWhCLGlDQUFBO0FBQ0E7RUFDSSxjQUFBO0VBQ0EsWUFBQTtFQUNBLFlBQUE7QUFFSjtBQUNBO0VBQ0ksb0JBQUE7QUFFSiIsImZpbGUiOiJzcmMvYXBwL3VzZXIvbG9naW4vbG9naW4ucGFnZS5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiQGNoYXJzZXQgXCJVVEYtOFwiO1xuLyogMy4xKSBGb3JtYXRhIGxpc3RhIGRlIGJvdMO1ZXMgKi9cbi5sb2dpbi10YWJsZSB7XG4gIGRpc3BsYXk6IHRhYmxlO1xuICBtYXJnaW46IGF1dG87XG4gIHdpZHRoOiAyMjBweDtcbn1cblxuLmxvZ2luLXRhYmxlIGlvbi1sYWJlbCB7XG4gIHBhZGRpbmctbGVmdDogMC41cmVtO1xufSJdfQ== */\";"]}